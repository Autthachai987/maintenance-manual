<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JLG Manual System</title>
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700;800&family=Kanit:wght@400;600;700;800;900&family=Bebas+Neue&display=swap" rel="stylesheet">
<style>
:root{--o:#F26522;--ol:#FF8243;--od:#D4520F;--og:rgba(242,101,34,0.25);--bk:#1A1A1A;--dk:#222;--gd:#2D2D2D;--gm:#3A3A3A;--gl:#888;--tx:#E8E8E8;--td:#AAA;--bd:#3A3A3A;--ok:#4CAF50;--dg:#E53935;--inf:#42A5F5;--wn:#FFA726}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Sarabun',sans-serif;background:var(--bk);color:var(--tx);min-height:100vh;line-height:1.6}
.login-overlay{position:fixed;inset:0;background:var(--bk);z-index:9999;display:flex;align-items:center;justify-content:center}
.login-overlay.hidden{display:none}
.login-box{background:var(--dk);border:1px solid var(--bd);border-radius:16px;padding:40px;width:90%;max-width:420px;text-align:center;box-shadow:0 20px 60px rgba(0,0,0,0.6)}
.login-logo{width:80px;height:80px;background:var(--o);border-radius:16px;display:flex;align-items:center;justify-content:center;font-family:'Bebas Neue',sans-serif;font-size:32px;color:#fff;margin:0 auto 20px;box-shadow:0 4px 30px rgba(242,101,34,0.4);position:relative;overflow:hidden}
.login-logo::after{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:linear-gradient(45deg,transparent 40%,rgba(255,255,255,0.15) 50%,transparent 60%);animation:sh 3s infinite}
@keyframes sh{0%{transform:translateX(-100%) rotate(45deg)}100%{transform:translateX(100%) rotate(45deg)}}
.login-box h2{font-family:'Kanit',sans-serif;font-size:22px;font-weight:800;margin-bottom:4px;color:#fff}
.login-box h2 span{color:var(--o)}
.login-box .sub{font-size:12px;color:var(--o);font-family:'Bebas Neue',sans-serif;letter-spacing:3px;margin-bottom:28px}
.login-fg{margin-bottom:16px;text-align:left}
.login-fg label{display:block;font-size:13px;font-weight:700;color:var(--td);margin-bottom:5px}
.login-fg input{width:100%;padding:12px 14px;background:var(--gd);border:1px solid var(--bd);border-radius:8px;color:var(--tx);font-family:'Sarabun',sans-serif;font-size:15px;outline:none}
.login-fg input:focus{border-color:var(--o);box-shadow:0 0 0 3px var(--og)}
.login-fg input::placeholder{color:var(--gl)}
.login-err{color:var(--dg);font-size:13px;font-weight:700;margin-bottom:12px;min-height:20px}
.login-btn{width:100%;padding:14px;background:var(--o);color:#fff;border:none;border-radius:8px;font-family:'Sarabun',sans-serif;font-size:16px;font-weight:800;cursor:pointer;transition:all .2s}
.login-btn:hover{background:var(--ol);transform:translateY(-1px)}
.login-footer{margin-top:20px;font-size:12px;color:var(--gl)}
.remember-row{display:flex;align-items:center;gap:8px;margin-bottom:16px}
.remember-row input[type=checkbox]{accent-color:var(--o);width:16px;height:16px}
.remember-row label{font-size:13px;color:var(--td);cursor:pointer}
.hdr{background:linear-gradient(180deg,#2A2A2A,var(--bk));border-bottom:3px solid var(--o);position:sticky;top:0;z-index:100}
.hdr-m{display:flex;align-items:center;justify-content:space-between;padding:14px 24px;max-width:1500px;margin:0 auto}
.la{display:flex;align-items:center;gap:16px}
.mt{display:none;background:var(--gd);border:1px solid var(--bd);color:var(--o);font-size:22px;padding:8px 12px;border-radius:8px;cursor:pointer}
.lb{width:48px;height:48px;background:var(--o);border-radius:10px;display:flex;align-items:center;justify-content:center;font-family:'Bebas Neue',sans-serif;font-size:20px;color:#fff;box-shadow:0 4px 20px rgba(242,101,34,0.3);position:relative;overflow:hidden}
.lb::after{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:linear-gradient(45deg,transparent 40%,rgba(255,255,255,0.15) 50%,transparent 60%);animation:sh 3s infinite}
.li h1{font-family:'Kanit',sans-serif;font-size:18px;font-weight:800;color:#fff}.li h1 span{color:var(--o)}
.li p{font-family:'Bebas Neue',sans-serif;font-size:11px;color:var(--o);letter-spacing:3px}
.hb{display:flex;gap:8px;align-items:center}
.user-info{display:flex;align-items:center;gap:10px;padding:6px 14px;background:var(--gd);border-radius:8px;border:1px solid var(--bd)}
.user-info .avatar{width:30px;height:30px;background:var(--o);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:800;color:#fff}
.user-info .uname{font-size:13px;color:var(--tx);font-weight:600}
.user-info .urole{font-size:10px;color:var(--td)}
.btn{padding:10px 18px;border:none;border-radius:6px;font-family:'Sarabun',sans-serif;font-size:14px;font-weight:700;cursor:pointer;transition:all .2s;display:inline-flex;align-items:center;gap:6px;white-space:nowrap}
.bo{background:var(--o);color:#fff}.bo:hover{background:var(--ol);transform:translateY(-1px)}
.bg{background:transparent;color:var(--td);border:1px solid var(--bd)}.bg:hover{border-color:var(--o);color:var(--o)}
.bs{padding:7px 14px;font-size:13px}
.bd{background:var(--dg);color:#fff}
.ss{background:var(--dk);padding:10px 24px;border-bottom:1px solid var(--bd)}
.si{max-width:1500px;margin:0 auto;display:flex;align-items:center;gap:12px}
.sw{position:relative;flex:1;max-width:500px}
.sw input{width:100%;padding:10px 14px 10px 40px;background:var(--gd);border:1px solid var(--bd);border-radius:6px;color:var(--tx);font-family:'Sarabun',sans-serif;font-size:14px;outline:none}
.sw input:focus{border-color:var(--o);box-shadow:0 0 0 2px var(--og)}
.sw input::placeholder{color:var(--gl)}
.sw .ic{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:var(--gl)}
.chs{display:flex;gap:6px;flex-wrap:wrap}
.ch{padding:6px 14px;border-radius:20px;font-size:12px;font-weight:700;cursor:pointer;border:1px solid var(--bd);background:var(--gd);color:var(--td);transition:all .15s}
.ch:hover,.ch.on{background:var(--o);color:#fff;border-color:var(--o)}
.ly{display:flex;max-width:1500px;margin:0 auto;min-height:calc(100vh - 160px)}
.app-wrap{display:none}.app-wrap.show{display:block}
.sb{width:280px;background:var(--dk);border-right:1px solid var(--bd);flex-shrink:0;overflow-y:auto;max-height:calc(100vh - 130px);position:sticky;top:130px}
.sb-d{padding:12px 18px 6px;font-size:10px;color:var(--gl);text-transform:uppercase;letter-spacing:2px;font-weight:700}
.sb-s{border-bottom:1px solid var(--bd)}
.sb-h{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;cursor:pointer;transition:background .15s;user-select:none}
.sb-h:hover{background:var(--gd)}
.sb-hl{display:flex;align-items:center;gap:10px}
.sb-i{width:34px;height:34px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:16px}
.sb-i.boom{background:rgba(242,101,34,0.15)}.sb-i.scissor{background:rgba(66,165,245,0.15)}.sb-i.sch{background:rgba(76,175,80,0.15)}
.sb-t{font-family:'Kanit',sans-serif;font-size:13px;font-weight:700}.sb-t small{display:block;font-family:'Sarabun',sans-serif;font-size:11px;font-weight:400;color:var(--td)}
.sb-c{background:var(--gm);color:var(--td);font-size:11px;padding:2px 8px;border-radius:10px;font-weight:700}
.sb-a{color:var(--gl);transition:transform .2s;font-size:12px}
.sb-s.op .sb-a{transform:rotate(180deg)}
.sb-is{display:none;padding:0 0 8px}.sb-s.op .sb-is{display:block}
.sb-it{padding:9px 16px 9px 60px;font-size:13px;cursor:pointer;transition:all .12s;display:flex;align-items:center;justify-content:space-between;color:var(--td);border-left:3px solid transparent}
.sb-it:hover{background:var(--gd);color:var(--tx);border-left-color:var(--od)}
.sb-it.on{background:rgba(242,101,34,0.08);color:var(--o);font-weight:700;border-left-color:var(--o)}
.sb-it .sb-b{font-size:11px;background:var(--gm);padding:1px 7px;border-radius:8px;color:var(--gl)}.sb-it.on .sb-b{background:var(--o);color:#fff}
.mn{flex:1;padding:24px;overflow-y:auto}
.sr{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:24px}
.stb{background:var(--dk);border:1px solid var(--bd);border-radius:10px;padding:16px;text-align:center;transition:border-color .2s}.stb:hover{border-color:var(--o)}
.stn{font-family:'Bebas Neue',sans-serif;font-size:36px;color:var(--o);line-height:1}
.stl{font-size:12px;color:var(--td);margin-top:4px}
.ct-top{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px}
.ct-top h2{font-family:'Kanit',sans-serif;font-size:22px;font-weight:800}.ct-top h2 .hl{color:var(--o)}
.bc{font-size:13px;color:var(--td);margin-bottom:16px}.bc span{color:var(--o);font-weight:600}
.gr{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:14px}
.cd{background:var(--dk);border:1px solid var(--bd);border-radius:10px;padding:20px;cursor:pointer;transition:all .2s;position:relative;overflow:hidden}
.cd::before{content:'';position:absolute;top:0;left:0;width:4px;height:100%;background:var(--o);opacity:0;transition:opacity .2s}
.cd:hover{border-color:var(--od);transform:translateY(-2px);box-shadow:0 4px 20px rgba(0,0,0,0.4)}.cd:hover::before{opacity:1}
.cd-top{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:10px}
.cd h3{font-family:'Kanit',sans-serif;font-size:15px;font-weight:700;line-height:1.4;flex:1}
.tg{font-size:10px;padding:3px 10px;border-radius:4px;font-weight:800;text-transform:uppercase;letter-spacing:.5px;flex-shrink:0;margin-left:10px}
.tg-op{background:rgba(242,101,34,0.15);color:var(--o)}.tg-pt{background:rgba(66,165,245,0.15);color:var(--inf)}.tg-sv{background:rgba(76,175,80,0.15);color:var(--ok)}.tg-sc{background:rgba(255,167,38,0.15);color:var(--wn)}
.cd-d{font-size:13px;color:var(--td);margin-bottom:14px;line-height:1.5;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.cd-m{display:flex;align-items:center;gap:14px;font-size:11px;color:var(--gl)}.cd-m span{display:flex;align-items:center;gap:4px}
.pd{width:8px;height:8px;border-radius:50%;display:inline-block}.pd.u{background:var(--dg);box-shadow:0 0 6px rgba(229,57,53,0.5)}.pd.i{background:var(--o)}.pd.n{background:var(--ok)}
.dp{display:none}.dp.show{display:block}
.dp-bk{display:inline-flex;align-items:center;gap:6px;color:var(--o);cursor:pointer;font-weight:700;font-size:14px;margin-bottom:20px}.dp-bk:hover{color:var(--ol)}
.dp-hd h1{font-family:'Kanit',sans-serif;font-size:24px;font-weight:800;margin-bottom:10px}
.dp-if{display:flex;flex-wrap:wrap;gap:16px;align-items:center;font-size:13px;color:var(--td);margin-bottom:16px}
.dp-ac{display:flex;gap:8px;margin-bottom:20px}
.dp-bd{background:var(--dk);border:1px solid var(--bd);border-radius:12px;padding:28px;line-height:1.9;font-size:15px}
.dp-bd h4{font-family:'Kanit',sans-serif;font-size:17px;color:var(--o);margin:24px 0 10px;padding-bottom:8px;border-bottom:1px solid var(--bd)}.dp-bd h4:first-child{margin-top:0}
.dp-bd ul,.dp-bd ol{padding-left:24px;margin:8px 0}.dp-bd li{margin:5px 0;color:var(--td)}
.wb{background:rgba(229,57,53,0.08);border-left:4px solid var(--dg);padding:12px 16px;border-radius:0 8px 8px 0;margin:14px 0;color:#ef9a9a;font-weight:600}
.tb{background:rgba(76,175,80,0.08);border-left:4px solid var(--ok);padding:12px 16px;border-radius:0 8px 8px 0;margin:14px 0;color:#a5d6a7}
.mbg{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.75);z-index:200;align-items:center;justify-content:center;backdrop-filter:blur(4px)}.mbg.open{display:flex}
.mbox{background:var(--dk);border:1px solid var(--bd);border-radius:14px;padding:28px;width:92%;max-width:720px;max-height:92vh;overflow-y:auto}
.mbox h2{font-family:'Kanit',sans-serif;font-size:20px;color:var(--o);margin-bottom:20px;padding-bottom:12px;border-bottom:2px solid var(--bd)}
.fg{margin-bottom:16px}.fg label{display:block;font-size:13px;font-weight:700;color:var(--td);margin-bottom:5px}
.fg input,.fg select,.fg textarea{width:100%;padding:10px 14px;background:var(--gd);border:1px solid var(--bd);border-radius:6px;color:var(--tx);font-family:'Sarabun',sans-serif;font-size:14px;outline:none}
.fg input:focus,.fg select:focus,.fg textarea:focus{border-color:var(--o);box-shadow:0 0 0 2px var(--og)}
.fg textarea{min-height:200px;resize:vertical;line-height:1.7}
.f2{display:grid;grid-template-columns:1fr 1fr;gap:14px}
.mft{display:flex;gap:10px;justify-content:flex-end;margin-top:20px;padding-top:16px;border-top:1px solid var(--bd)}
.tst{position:fixed;bottom:24px;right:24px;padding:14px 24px;border-radius:8px;font-weight:700;z-index:300;transform:translateY(80px);opacity:0;transition:all .3s;font-size:14px}.tst.show{transform:translateY(0);opacity:1}.tst.ok{background:var(--ok);color:#fff}.tst.err{background:var(--dg);color:#fff}
.emp{text-align:center;padding:60px 20px;color:var(--gl);grid-column:1/-1}
.pdf-sec{margin-top:20px;padding-top:20px;border-top:1px solid var(--bd)}
.pdf-item{display:flex;align-items:center;gap:12px;padding:10px 14px;background:var(--gd);border-radius:8px;margin-bottom:8px;border:1px solid var(--bd)}
.pdf-item .pfi{font-size:24px}.pdf-item .pfn{flex:1;font-size:13px;font-weight:600;word-break:break-all}.pdf-item .pfd{font-size:11px;color:var(--gl)}
.pfb{padding:5px 10px;border:none;border-radius:4px;font-size:11px;font-weight:700;cursor:pointer;font-family:'Sarabun',sans-serif}
.pfb-v{background:var(--inf);color:#fff}.pfb-d{background:var(--dg);color:#fff}
.uz{border:2px dashed var(--bd);border-radius:10px;padding:24px;text-align:center;cursor:pointer;transition:all .2s;margin-top:12px}
.uz:hover{border-color:var(--o);background:rgba(242,101,34,0.05)}
.uz-i{font-size:36px;opacity:.6}.uz-t{font-size:13px;color:var(--td)}.uz-t strong{color:var(--o)}
.uprog{margin-top:8px;height:4px;background:var(--gd);border-radius:2px;overflow:hidden;display:none}
.uprog .ubar{height:100%;background:var(--o);width:0;transition:width .3s}
.pvw{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.85);z-index:250;align-items:center;justify-content:center}.pvw.open{display:flex}
.pvw-box{width:95%;max-width:900px;height:90vh;background:var(--dk);border-radius:14px;overflow:hidden;display:flex;flex-direction:column;border:1px solid var(--bd)}
.pvw-head{display:flex;align-items:center;justify-content:space-between;padding:12px 18px;border-bottom:1px solid var(--bd)}
.pvw-head h3{font-family:'Kanit',sans-serif;font-size:16px;color:var(--o)}
.pvw-body{flex:1}.pvw-body iframe{width:100%;height:100%;border:none}
.gas-box{background:rgba(242,101,34,0.08);border:1px solid var(--o);border-radius:10px;padding:16px;margin-bottom:20px}
.gas-box h4{font-family:'Kanit',sans-serif;color:var(--o);margin-bottom:8px}
.gas-box input{width:100%;padding:10px;background:var(--gd);border:1px solid var(--bd);border-radius:6px;color:var(--tx);font-size:13px;outline:none;font-family:monospace}
.gas-box .gn{font-size:12px;color:var(--td);margin-top:6px}
@media(max-width:900px){.sb{display:none}.sb.mob{display:block;position:fixed;top:0;left:0;bottom:0;z-index:150;width:280px}.mt{display:flex}.sr{grid-template-columns:repeat(2,1fr)}.gr{grid-template-columns:1fr}.f2{grid-template-columns:1fr}.hb .bl{display:none}.chs{display:none}.user-info .uname,.user-info .urole{display:none}}
@media print{.hdr,.sb,.btn,.ss,.sr,.dp-ac,.user-info,.gas-box,.pdf-sec{display:none!important}body{background:#fff;color:#222}.mn{padding:0}.dp-bd{border:none;padding:0;background:#fff}.dp-bd h4{color:#D4520F}}
::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:var(--bk)}::-webkit-scrollbar-thumb{background:var(--gm);border-radius:3px}
</style>
</head>
<body>

<div class="login-overlay" id="loginScreen">
<div class="login-box">
<div class="login-logo">JLG</div>
<h2>‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á <span>JLG</span></h2>
<div class="sub">MAINTENANCE MANUAL SYSTEM</div>
<div class="login-fg"><label>Username</label><input type="text" id="loginUser" placeholder="‡∏Å‡∏£‡∏≠‡∏Å Username" onkeydown="if(event.key==='Enter')doLogin()"></div>
<div class="login-fg"><label>Password</label><input type="password" id="loginPass" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" onkeydown="if(event.key==='Enter')doLogin()"></div>
<div class="remember-row"><input type="checkbox" id="remMe"><label for="remMe">‡∏à‡∏î‡∏à‡∏≥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</label></div>
<div class="login-err" id="loginErr"></div>
<button class="login-btn" onclick="doLogin()">üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
<div class="login-footer">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡∏°‡∏ä‡πà‡∏≤‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á JLG ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</div>
</div></div>

<div class="app-wrap" id="appWrap">
<header class="hdr"><div class="hdr-m"><div class="la"><button class="mt" onclick="document.getElementById('sb').classList.toggle('mob')">‚ò∞</button><div class="lb">JLG</div><div class="li"><h1>‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á <span>JLG</span></h1><p>MAINTENANCE MANUAL SYSTEM</p></div></div><div class="hb"><div class="user-info"><div class="avatar" id="uAv">A</div><div><div class="uname" id="uNm">-</div><div class="urole" id="uRl">-</div></div></div><button class="btn bo bs" id="btnAdd" onclick="openM()" style="display:none">Ôºã ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠</button><button class="btn bg bs" onclick="doLogout()">üö™ ‡∏≠‡∏≠‡∏Å</button></div></div></header>
<div class="ss"><div class="si"><div class="sw"><span class="ic">üîç</span><input id="q" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠..." oninput="renderCards()"></div><div class="chs"><div class="ch on" onclick="setCh('all',this)">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div><div class="ch" onclick="setCh('Operation Manual',this)">üìñ Operation</div><div class="ch" onclick="setCh('Part Manual',this)">üî© Part</div><div class="ch" onclick="setCh('Service Manual',this)">üõ†Ô∏è Service</div><div class="ch" onclick="setCh('Schematic',this)">üìê Schematic</div></div></div></div>
<div class="ly"><aside class="sb" id="sb"></aside><main class="mn"><div id="gasArea"></div><div class="sr" id="sts"></div><div id="lv"><div class="bc" id="bc"></div><div class="ct-top"><h2 id="ct"></h2></div><div class="gr" id="gr"></div></div><div class="dp" id="dp"></div></main></div>
</div>

<div class="mbg" id="mbg" onclick="if(event.target===this)closeM()"><div class="mbox"><h2 id="mtt">üîß ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà</h2><div class="fg"><label>‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠ *</label><input id="fN"></div><div class="f2"><div class="fg"><label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á *</label><select id="fE"><option value="">--</option><option value="Boom Lift">üèóÔ∏è Boom Lift</option><option value="Scissor Lift">‚úÇÔ∏è Scissor Lift</option></select></div><div class="fg"><label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠ *</label><select id="fD"><option value="">--</option><option value="Operation Manual">üìñ Operation</option><option value="Part Manual">üî© Part</option><option value="Service Manual">üõ†Ô∏è Service</option><option value="Schematic">üìê Schematic</option></select></div></div><div class="f2"><div class="fg"><label>‡∏£‡∏∏‡πà‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</label><input id="fM"></div><div class="fg"><label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</label><select id="fP"><option>‡∏õ‡∏Å‡∏ï‡∏¥</option><option>‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</option><option>‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô</option></select></div></div><div class="fg"><label>‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ *</label><textarea id="fC"></textarea></div><div class="mft"><button class="btn bg" onclick="closeM()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button><button class="btn bo" onclick="saveM()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button></div></div></div>

<div class="pvw" id="pvw" onclick="if(event.target===this)closePV()"><div class="pvw-box"><div class="pvw-head"><h3 id="pvwT">PDF</h3><button class="btn bg bs" onclick="closePV()">‚úï ‡∏õ‡∏¥‡∏î</button></div><div class="pvw-body"><iframe id="pvwF"></iframe></div></div></div>

<div class="tst" id="tt"></div>
<input type="file" id="pdfIn" accept=".pdf" style="display:none">

<script>
// ===== USERS =====
var USERS=[
{username:'admin',password:'admin1234',name:'‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡πà‡∏≤‡∏á',role:'admin',display:'Admin'},
{username:'tech1',password:'tech1234',name:'‡∏ä‡πà‡∏≤‡∏á 1',role:'tech',display:'Technician'},
{username:'tech2',password:'tech2234',name:'‡∏ä‡πà‡∏≤‡∏á 2',role:'tech',display:'Technician'},
{username:'tech3',password:'tech3234',name:'‡∏ä‡πà‡∏≤‡∏á 3',role:'tech',display:'Technician'},
{username:'tech4',password:'tech4234',name:'‡∏ä‡πà‡∏≤‡∏á 4',role:'tech',display:'Technician'},
{username:'tech5',password:'tech5234',name:'‡∏ä‡πà‡∏≤‡∏á 5',role:'tech',display:'Technician'},
{username:'tech6',password:'tech6234',name:'‡∏ä‡πà‡∏≤‡∏á 6',role:'tech',display:'Technician'},
{username:'tech7',password:'tech7234',name:'‡∏ä‡πà‡∏≤‡∏á 7',role:'tech',display:'Technician'},
{username:'tech8',password:'tech8234',name:'‡∏ä‡πà‡∏≤‡∏á 8',role:'tech',display:'Technician'},
{username:'tech9',password:'tech9234',name:'‡∏ä‡πà‡∏≤‡∏á 9',role:'tech',display:'Technician'},
{username:'tech10',password:'tech0234',name:'‡∏ä‡πà‡∏≤‡∏á 10',role:'tech',display:'Technician'},
{username:'tech11',password:'tech1134',name:'‡∏ä‡πà‡∏≤‡∏á 11',role:'tech',display:'Technician'},
{username:'tech12',password:'tech1234x',name:'‡∏ä‡πà‡∏≤‡∏á 12',role:'tech',display:'Technician'}
];
var curUser=null;
var GAS_URL=localStorage.getItem('jlg_gas')||'';

function doLogin(){
var u=document.getElementById('loginUser').value.trim(),p=document.getElementById('loginPass').value;
var f=null;
for(var i=0;i<USERS.length;i++){if(USERS[i].username===u&&USERS[i].password===p){f=USERS[i];break;}}
if(!f){document.getElementById('loginErr').textContent='‚ùå ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';return;}
curUser=f;
if(document.getElementById('remMe').checked){localStorage.setItem('jlg_ses',JSON.stringify({username:f.username}));}
showApp();
}
function doLogout(){curUser=null;localStorage.removeItem('jlg_ses');document.getElementById('appWrap').classList.remove('show');document.getElementById('loginScreen').classList.remove('hidden');document.getElementById('loginUser').value='';document.getElementById('loginPass').value='';document.getElementById('loginErr').textContent='';}
function checkSession(){
var s=localStorage.getItem('jlg_ses');
if(s){try{var d=JSON.parse(s);for(var i=0;i<USERS.length;i++){if(USERS[i].username===d.username){curUser=USERS[i];showApp();return;}}}catch(e){}}
}
function showApp(){
document.getElementById('loginScreen').classList.add('hidden');
document.getElementById('appWrap').classList.add('show');
document.getElementById('uNm').textContent=curUser.name;
document.getElementById('uRl').textContent=curUser.display;
document.getElementById('uAv').textContent=curUser.name.charAt(0);
document.getElementById('btnAdd').style.display=curUser.role==='admin'?'inline-flex':'none';
if(curUser.role==='admin'){
document.getElementById('gasArea').innerHTML='<div class="gas-box"><h4>‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ API ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î PDF</h4><input id="gasInp" value="'+GAS_URL+'" placeholder="‡∏ß‡∏≤‡∏á Google Apps Script Web App URL"><button class="btn bo bs" style="margin-top:8px" onclick="saveGas()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å URL</button><div class="gn">‡πÉ‡∏™‡πà URL ‡∏à‡∏≤‡∏Å Google Apps Script (‡∏ó‡∏≥‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)</div></div>';
}else{document.getElementById('gasArea').innerHTML='';}
initData();
}
function saveGas(){GAS_URL=document.getElementById('gasInp').value.trim();localStorage.setItem('jlg_gas',GAS_URL);toast('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å API URL ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‚úÖ');}

// ===== DATA =====
var SK='jlg_m_v6';
var SAM=[
{id:'b-op-1',name:'Boom Lift Pre-Operation Inspection (Daily)',equipType:'Boom Lift',docType:'Operation Manual',model:'JLG 450AJ / 600AJ / 800AJ',priority:'‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô',content:"## ‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (Walk-Around)\n- ‡∏ï‡∏£‡∏ß‡∏à‡∏£‡∏≠‡∏¢‡∏£‡∏±‡πà‡∏ß‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÑ‡∏Æ‡∏î‡∏£‡∏≠‡∏•‡∏¥‡∏Å ‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á Coolant\n- ‡∏ï‡∏£‡∏ß‡∏à‡∏¢‡∏≤‡∏á ‡∏•‡∏°‡∏ï‡∏≤‡∏°‡∏™‡πÄ‡∏õ‡∏Ñ\n- ‡∏ï‡∏£‡∏ß‡∏à Guardrail + ‡∏õ‡∏£‡∏∞‡∏ï‡∏π‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤\n- ‡∏ï‡∏£‡∏ß‡∏à‡∏õ‡πâ‡∏≤‡∏¢‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô ‡∏™‡∏ï‡∏¥‡πä‡∏Å‡πÄ‡∏Å‡∏≠‡∏£‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢\n- ‡∏ï‡∏£‡∏ß‡∏à Lanyard Anchor Point\n\n## ‡∏´‡∏•‡∏±‡∏á‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó (Function Test)\n- Emergency Stop ‡∏ó‡∏±‡πâ‡∏á Platform + Ground\n- Boom Up/Down Telescope In/Out\n- Swing Left/Right\n- Tilt Alarm\n- Drive & Steer 4 ‡∏ó‡∏¥‡∏®\n- Horn\n\n‚ö†Ô∏è ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏ö‡∏Å‡∏û‡∏£‡πà‡∏≠‡∏á ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ‡∏ï‡∏¥‡∏î OUT OF SERVICE\n‚úÖ ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö: ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ 10-15 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πâ‡∏≤",createdAt:'2025-02-01',updatedAt:'2025-02-14',author:'‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡πà‡∏≤‡∏á'},
{id:'b-op-2',name:'‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Platform Control',equipType:'Boom Lift',docType:'Operation Manual',model:'JLG 450AJ',priority:'‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç',content:"## ‡πÅ‡∏ú‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏ö‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤\n- Joystick ‡∏ã‡πâ‡∏≤‡∏¢: Boom Up/Down\n- Joystick ‡∏Ç‡∏ß‡∏≤: Swing\n- Toggle: Telescope\n- Foot Switch: Drive\n\n## ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á\n1. Key Switch OFF\n2. E-Stop ‡∏î‡∏∂‡∏á‡∏≠‡∏≠‡∏Å\n3. Key Switch ON\n4. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Platform Control\n5. ‡∏£‡∏≠ Self-Test\n\n‚ö†Ô∏è ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ‡∏™‡∏ß‡∏° Harness ‡∏Å‡πà‡∏≠‡∏ô‡∏¢‡∏Å‡∏ö‡∏π‡∏°‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á\n‚úÖ ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö: ‡∏´‡∏±‡∏î‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏û‡∏∑‡πâ‡∏ô‡∏£‡∏≤‡∏ö‡∏Å‡πà‡∏≠‡∏ô",createdAt:'2025-02-03',updatedAt:'2025-02-14',author:'‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡πà‡∏≤‡∏á'},
{id:'b-op-3',name:'‡∏Å‡∏é‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ö‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏π‡∏á',equipType:'Boom Lift',docType:'Operation Manual',model:'‡∏ó‡∏∏‡∏Å‡∏£‡∏∏‡πà‡∏ô',priority:'‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô',content:"## ‡∏Å‡∏é‡πÄ‡∏´‡∏•‡πá‡∏Å 5 ‡∏Ç‡πâ‡∏≠\n1. ‡∏™‡∏ß‡∏° Full Body Harness ‡∏ï‡∏•‡∏≠‡∏î‡πÄ‡∏ß‡∏•‡∏≤\n2. ‡∏¢‡∏∂‡∏î Lanyard ‡∏Å‡∏±‡∏ö Anchor Point\n3. ‡∏´‡πâ‡∏≤‡∏°‡∏õ‡∏µ‡∏ô‡∏£‡∏≤‡∏ß‡∏Å‡∏±‡∏ô‡∏ï‡∏Å\n4. ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ‡∏•‡∏°‡πÄ‡∏Å‡∏¥‡∏ô 45 km/h\n5. ‡∏´‡πâ‡∏≤‡∏°‡∏Ç‡∏±‡∏ö‡∏Ç‡∏ì‡∏∞‡∏ö‡∏π‡∏°‡∏¢‡∏Å‡∏™‡∏π‡∏á\n\n## PPE\n- ‡∏´‡∏°‡∏ß‡∏Å‡∏ô‡∏¥‡∏£‡∏†‡∏±‡∏¢\n- Full Body Harness + Lanyard\n- ‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏ô‡∏¥‡∏£‡∏†‡∏±‡∏¢\n\n‚ö†Ô∏è ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ‡πÑ‡∏°‡πà‡∏™‡∏ß‡∏° Harness = ‡∏ù‡πà‡∏≤‡∏ù‡∏∑‡∏ô‡∏Å‡∏é‡∏£‡πâ‡∏≤‡∏¢‡πÅ‡∏£‡∏á",createdAt:'2025-01-05',updatedAt:'2025-02-14',author:'‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡πà‡∏≤‡∏á'},
{id:'b-sv-1',name:'‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ã‡∏µ‡∏•‡∏Å‡∏£‡∏∞‡∏ö‡∏≠‡∏Å‡∏™‡∏π‡∏ö Boom Cylinder',equipType:'Boom Lift',docType:'Service Manual',model:'JLG 450AJ / 600AJ',priority:'‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç',content:"## ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠\n- Seal Kit ‡∏ï‡∏≤‡∏° Part Number\n- ‡∏õ‡∏£‡∏∞‡πÅ‡∏à 17 19 24 32mm\n- ‡∏ñ‡∏≤‡∏î‡∏£‡∏≠‡∏á ‡∏à‡∏≤‡∏£‡∏ö‡∏µ‡∏ã‡∏¥‡∏•‡∏¥‡πÇ‡∏Ñ‡∏ô\n\n## ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô\n1. ‡∏•‡∏î‡∏ö‡∏π‡∏°‡∏•‡∏á‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î\n2. ‡∏î‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á ‡∏õ‡∏•‡∏î‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô\n3. ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏™‡∏≤‡∏¢‡∏ó‡πà‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏ñ‡∏≠‡∏î\n4. ‡∏ñ‡∏≠‡∏î‡∏Å‡∏£‡∏∞‡∏ö‡∏≠‡∏Å‡∏™‡∏π‡∏ö\n5. ‡∏ñ‡∏≠‡∏î‡∏ã‡∏µ‡∏•‡πÄ‡∏Å‡πà‡∏≤ ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î\n6. ‡πÉ‡∏™‡πà‡∏ã‡∏µ‡∏•‡πÉ‡∏´‡∏°‡πà ‡∏ó‡∏≤‡∏à‡∏≤‡∏£‡∏ö‡∏µ\n7. ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö\n\n‚ö†Ô∏è ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏™‡∏¥‡πà‡∏á‡∏™‡∏Å‡∏õ‡∏£‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö\n‚úÖ ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö: ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏ó‡∏∏‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô",createdAt:'2025-01-15',updatedAt:'2025-02-12',author:'‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡πà‡∏≤‡∏á'},
{id:'b-sv-2',name:'‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á Deutz Engine',equipType:'Boom Lift',docType:'Service Manual',model:'JLG 450AJ (Deutz)',priority:'‡∏õ‡∏Å‡∏ï‡∏¥',content:"## ‡∏ß‡∏±‡∏™‡∏î‡∏∏\n- ‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô 15W-40 CI-4 x 7 ‡∏•‡∏¥‡∏ï‡∏£\n- ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏á‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á\n\n## ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô\n1. ‡∏ß‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á 5 ‡∏ô‡∏≤‡∏ó‡∏µ ‡∏î‡∏±‡∏ö\n2. ‡∏ñ‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÄ‡∏Å‡πà‡∏≤\n3. ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏á\n4. ‡πÄ‡∏ï‡∏¥‡∏°‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà\n5. ‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó ‡∏ï‡∏£‡∏ß‡∏à‡∏£‡∏∞‡∏î‡∏±‡∏ö\n\n‚úÖ ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ó‡∏∏‡∏Å 250 ‡∏ä‡∏°.",createdAt:'2025-02-05',updatedAt:'2025-02-13',author:'‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡πà‡∏≤‡∏á'},
{id:'b-pt-1',name:'‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà‡∏™‡∏¥‡πâ‡∏ô‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏á Boom Lift',equipType:'Boom Lift',docType:'Part Manual',model:'JLG 450AJ',priority:'‡∏õ‡∏Å‡∏ï‡∏¥',content:"## Filters\n- Engine Oil: #7020403 (250‡∏ä‡∏°.)\n- Fuel: #7024037 (500‡∏ä‡∏°.)\n- Hydraulic: #1001166539 (500‡∏ä‡∏°.)\n- Air Primary: #1001125431\n\n## ‡∏ã‡∏µ‡∏•\n- Boom Cyl Seal Kit: #8000188\n- Swing Bearing Seal: #4140615\n\n## ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤\n- Battery 12V: #8036509\n- Glow Plug: #7030486\n\n‚úÖ ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö: ‡∏™‡∏±‡πà‡∏á Filter Kit ‡∏£‡∏ß‡∏°‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏Å‡∏ß‡πà‡∏≤",createdAt:'2025-01-25',updatedAt:'2025-02-10',author:'‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡πà‡∏≤‡∏á'},
{id:'s-op-1',name:'Scissor Lift Pre-Operation Inspection',equipType:'Scissor Lift',docType:'Operation Manual',model:'JLG 3246ES / 4045R',priority:'‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô',content:"## ‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô\n- ‡∏ï‡∏£‡∏ß‡∏à‡∏ô‡πâ‡∏≥‡∏Å‡∏•‡∏±‡πà‡∏ô‡πÅ‡∏ö‡∏ï‡∏ó‡∏∏‡∏Å‡πÄ‡∏ã‡∏•‡∏•‡πå\n- ‡∏ï‡∏£‡∏ß‡∏à‡∏Ç‡∏±‡πâ‡∏ß‡πÅ‡∏ö‡∏ï\n- ‡∏ï‡∏£‡∏ß‡∏à‡∏¢‡∏≤‡∏á + Caster\n- ‡∏ï‡∏£‡∏ß‡∏à Pothole Protection\n- ‡∏ï‡∏£‡∏ß‡∏à‡∏£‡∏≤‡∏ß‡∏Å‡∏±‡∏ô‡∏ï‡∏Å\n\n## Function Test\n- E-Stop ‡∏ö‡∏ô+‡∏•‡πà‡∏≤‡∏á\n- ‡∏¢‡∏Å-‡∏•‡∏î\n- Drive & Steer\n- Horn Tilt Sensor\n\n‚ö†Ô∏è ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ‡πÉ‡∏ä‡πâ‡∏ö‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏£‡∏≤‡∏ö ‡∏•‡∏≤‡∏î‡∏ä‡∏±‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 3¬∞\n‚úÖ ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö: ‡∏ä‡∏≤‡∏£‡πå‡∏à‡πÅ‡∏ö‡∏ï‡∏´‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô",createdAt:'2025-02-02',updatedAt:'2025-02-14',author:'‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡πà‡∏≤‡∏á'},
{id:'s-sv-1',name:'‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà Fronius',equipType:'Scissor Lift',docType:'Service Manual',model:'JLG 3246ES + Fronius',priority:'‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç',content:"## ‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏ö‡∏ï (‡∏ó‡∏∏‡∏Å‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå)\n- ‡∏ô‡πâ‡∏≥‡∏Å‡∏•‡∏±‡πà‡∏ô‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡πÄ‡∏û‡∏•‡∏ó 10-15mm\n- SG ‡πÄ‡∏ï‡πá‡∏° 1.275-1.285\n- ‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô 6V Cell 6.2-6.4V\n\n## ‡∏ä‡∏≤‡∏£‡πå‡∏à Fronius\n1. ‡∏õ‡∏¥‡∏î‡∏™‡∏ß‡∏¥‡∏ï‡∏ä‡πå\n2. ‡∏ï‡πà‡∏≠‡∏õ‡∏•‡∏±‡πä‡∏Å‡∏ä‡∏≤‡∏£‡πå‡∏à\n3. ‡πÄ‡∏õ‡∏¥‡∏î‡∏ä‡∏≤‡∏£‡πå‡∏à‡πÄ‡∏à‡∏≠‡∏£‡πå\n4. ‡∏ä‡∏≤‡∏£‡πå‡∏à‡∏à‡∏ô‡πÄ‡∏ï‡πá‡∏°\n\n‚ö†Ô∏è ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ‡∏´‡πâ‡∏≤‡∏°‡∏ä‡∏≤‡∏£‡πå‡∏à‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏ö‡∏≠‡∏≤‡∏Å‡∏≤‡∏®\n‚úÖ ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö: Equalizing Charge ‡∏ó‡∏∏‡∏Å 5-10 ‡∏£‡∏≠‡∏ö",createdAt:'2025-01-20',updatedAt:'2025-02-11',author:'‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡πà‡∏≤‡∏á'},
{id:'s-pt-1',name:'‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà‡∏™‡∏¥‡πâ‡∏ô‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏á Scissor Lift',equipType:'Scissor Lift',docType:'Part Manual',model:'JLG 3246ES',priority:'‡∏õ‡∏Å‡∏ï‡∏¥',content:"## ‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà\n- Battery 6V Deep Cycle x4\n- Charger Fuse\n\n## ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏á\n- Hydraulic: #1001112455\n\n## Wear Parts\n- Slide Block Wear Pad\n- Pivot Bushing\n- Tire Non-marking 15x5\n\n‚úÖ ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö: ‡∏¢‡∏≤‡∏á Non-marking ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Indoor",createdAt:'2025-01-28',updatedAt:'2025-02-09',author:'‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡πà‡∏≤‡∏á'},
{id:'sc-1',name:'Electrical Schematic - JLG 450AJ',equipType:'Boom Lift',docType:'Schematic',model:'JLG 450AJ',priority:'‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç',content:"## ‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ 12V\n- Battery ‚Üí Disconnect ‚Üí Fuse Panel\n- ECM ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° Deutz Engine\n\n## ‡∏ß‡∏á‡∏à‡∏£\n1. Starting: Battery ‚Üí Key ‚Üí Starter\n2. Charging: Alternator ‚Üí Battery\n3. Control: Controller ‚Üí Valves\n4. Safety: E-Stop ‚Üí Tilt ‚Üí Interlock\n\n## ‡∏™‡∏µ‡∏™‡∏≤‡∏¢‡πÑ‡∏ü\n- ‡πÅ‡∏î‡∏á +12V ‡∏î‡∏≥ GND\n- ‡∏™‡πâ‡∏° Ignition ‡∏Ç‡∏≤‡∏ß Signal\n\n‚ö†Ô∏è ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ‡∏õ‡∏•‡∏î Disconnect ‡∏Å‡πà‡∏≠‡∏ô‡∏ã‡πà‡∏≠‡∏°‡πÑ‡∏ü‡∏ü‡πâ‡∏≤",createdAt:'2025-01-10',updatedAt:'2025-02-14',author:'‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡πà‡∏≤‡∏á'},
{id:'sc-2',name:'Hydraulic Schematic - JLG 450AJ',equipType:'Boom Lift',docType:'Schematic',model:'JLG 450AJ',priority:'‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç',content:"## ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°\n- Gear Pump ‡∏Ç‡∏±‡∏ö‡πÇ‡∏î‡∏¢ Engine\n- Main Control Valve\n- Tank ~75L\n\n## ‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô\n- Main Relief 3000 PSI\n- Boom 2800 PSI\n- Steer 1500 PSI\n\n## ‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô AW46\n- ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ó‡∏∏‡∏Å 1000 ‡∏ä‡∏°.\n\n‚ö†Ô∏è ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ‡∏´‡πâ‡∏≤‡∏°‡πÅ‡∏ï‡∏∞‡∏™‡∏≤‡∏¢‡∏Ç‡∏ì‡∏∞‡∏°‡∏µ‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô",createdAt:'2025-01-12',updatedAt:'2025-02-14',author:'‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡πà‡∏≤‡∏á'},
{id:'sc-3',name:'Electrical Schematic - Scissor 3246ES',equipType:'Scissor Lift',docType:'Schematic',model:'JLG 3246ES',priority:'‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç',content:"## ‡∏£‡∏∞‡∏ö‡∏ö 24V DC\n- 4x6V Battery = 24V\n- Contactor ‚Üí Controller\n\n## ‡∏ß‡∏á‡∏à‡∏£\n1. Power: Battery ‚Üí Contactor\n2. Lift: Controller ‚Üí Pump Motor\n3. Drive: Controller ‚Üí Drive Motor\n4. Safety: E-Stop ‚Üí Tilt ‚Üí Gate\n\n## Sensor\n- Tilt ‡πÉ‡∏ï‡πâ Platform\n- Gate Switch ‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏ï‡∏π\n- Pothole Guard ‡∏Ç‡∏≤‡∏Ñ‡πâ‡∏≥ 4 ‡∏à‡∏∏‡∏î\n\n‚ö†Ô∏è ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: 24V ‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡∏™‡∏π‡∏á ‡∏õ‡∏•‡∏î Plug ‡∏Å‡πà‡∏≠‡∏ô‡∏ã‡πà‡∏≠‡∏°\n‚úÖ ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö: ‡∏ï‡∏£‡∏ß‡∏à Gate Switch + Tilt Sensor ‡∏Å‡πà‡∏≠‡∏ô",createdAt:'2025-01-18',updatedAt:'2025-02-12',author:'‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡πà‡∏≤‡∏á'}
];

var D=[],FT={eq:null,dt:null,chip:'all'},eid=null;
function initData(){var s=localStorage.getItem(SK);D=s?JSON.parse(s):SAM.slice();if(!s)sv();render();}
function sv(){localStorage.setItem(SK,JSON.stringify(D));}
function render(){renderSB();renderSt();renderCards();}

function renderSB(){
var t={};D.forEach(function(m){if(!t[m.equipType])t[m.equipType]={};if(!t[m.equipType][m.docType])t[m.equipType][m.docType]=[];t[m.equipType][m.docType].push(m);});
var sb=document.getElementById('sb');
var eo=['Boom Lift','Scissor Lift'],doo=['Operation Manual','Part Manual','Service Manual','Schematic'];
var ei={'Boom Lift':'üèóÔ∏è','Scissor Lift':'‚úÇÔ∏è'},ec={'Boom Lift':'boom','Scissor Lift':'scissor'};
var di={'Operation Manual':'üìñ','Part Manual':'üî©','Service Manual':'üõ†Ô∏è','Schematic':'üìê'};
var h='<div class="sb-d">EQUIPMENT TYPE</div>';
h+='<div class="sb-s op"><div class="sb-h" onclick="flt(null,null)"><div class="sb-hl"><div class="sb-i boom">üìö</div><div class="sb-t">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div></div><span class="sb-c">'+D.length+'</span></div></div>';
eo.forEach(function(eq){if(!t[eq])return;var c=D.filter(function(m){return m.equipType===eq;}).length;var op=FT.eq===eq;
h+='<div class="sb-s '+(op?'op':'')+'"><div class="sb-h" onclick="this.parentElement.classList.toggle(\'op\')"><div class="sb-hl"><div class="sb-i '+ec[eq]+'">'+ei[eq]+'</div><div class="sb-t">'+eq+'<small>'+c+' ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠</small></div></div><span class="sb-a">‚ñº</span></div><div class="sb-is">';
doo.forEach(function(dt){if(!t[eq]||!t[eq][dt])return;var n=t[eq][dt].length;var a=FT.eq===eq&&FT.dt===dt;
h+='<div class="sb-it '+(a?'on':'')+'" onclick="flt(\''+eq+'\',\''+dt+'\')">'+di[dt]+' '+dt+'<span class="sb-b">'+n+'</span></div>';});
h+='<div class="sb-it '+(FT.eq===eq&&!FT.dt?'on':'')+'" onclick="flt(\''+eq+'\',null)" style="border-top:1px solid var(--bd);color:var(--o);font-weight:700">üìã ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î<span class="sb-b">'+c+'</span></div></div></div>';});
var sc=D.filter(function(m){return m.docType==='Schematic';}).length;
if(sc)h+='<div class="sb-d">SCHEMATIC</div><div class="sb-s op"><div class="sb-h" onclick="flt(null,\'Schematic\')"><div class="sb-hl"><div class="sb-i sch">üìê</div><div class="sb-t">Schematic ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div></div><span class="sb-c">'+sc+'</span></div></div>';
sb.innerHTML=h;
}
function flt(eq,dt){FT.eq=eq;FT.dt=dt;FT.chip='all';document.querySelectorAll('.ch').forEach(function(c){c.classList.remove('on');});document.querySelector('.ch').classList.add('on');closeDP();render();}
function setCh(v,el){FT.chip=v;document.querySelectorAll('.ch').forEach(function(c){c.classList.remove('on');});el.classList.add('on');renderCards();}
function getL(){var l=D.slice();var s=document.getElementById('q').value.toLowerCase();if(FT.eq)l=l.filter(function(m){return m.equipType===FT.eq;});if(FT.dt)l=l.filter(function(m){return m.docType===FT.dt;});if(FT.chip!=='all')l=l.filter(function(m){return m.docType===FT.chip;});if(s)l=l.filter(function(m){return m.name.toLowerCase().indexOf(s)>=0||m.content.toLowerCase().indexOf(s)>=0||(m.model&&m.model.toLowerCase().indexOf(s)>=0);});return l;}
function renderSt(){var b=D.filter(function(m){return m.equipType==='Boom Lift';}).length;var s=D.filter(function(m){return m.equipType==='Scissor Lift';}).length;var sc=D.filter(function(m){return m.docType==='Schematic';}).length;document.getElementById('sts').innerHTML='<div class="stb"><div class="stn">'+D.length+'</div><div class="stl">‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div></div><div class="stb"><div class="stn">'+b+'</div><div class="stl">Boom Lift</div></div><div class="stb"><div class="stn">'+s+'</div><div class="stl">Scissor Lift</div></div><div class="stb"><div class="stn">'+sc+'</div><div class="stl">Schematic</div></div>';}
function renderCards(){
var l=getL(),g=document.getElementById('gr'),ct=document.getElementById('ct'),bc=document.getElementById('bc');
var tt='‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠<span class="hl">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>',b='';
if(FT.eq&&FT.dt){tt='<span class="hl">'+FT.eq+'</span> ‚Ä∫ '+FT.dt;b='‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å ‚Ä∫ '+FT.eq+' ‚Ä∫ <span>'+FT.dt+'</span>';}
else if(FT.eq){tt='<span class="hl">'+FT.eq+'</span>';b='‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å ‚Ä∫ <span>'+FT.eq+'</span>';}
else if(FT.dt){tt='<span class="hl">'+FT.dt+'</span>';b='‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å ‚Ä∫ <span>'+FT.dt+'</span>';}
ct.innerHTML=tt;bc.innerHTML=b;
if(!l.length){g.innerHTML='<div class="emp"><p style="font-size:48px;opacity:.4">üì≠</p><p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠</p></div>';return;}
var tc={'Operation Manual':'tg-op','Part Manual':'tg-pt','Service Manual':'tg-sv','Schematic':'tg-sc'};
var pc={'‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô':'u','‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç':'i','‡∏õ‡∏Å‡∏ï‡∏¥':'n'};
g.innerHTML=l.map(function(m){return '<div class="cd" onclick="openD(\''+m.id+'\')"><div class="cd-top"><h3>'+m.name+'</h3><span class="tg '+(tc[m.docType]||'')+'">'+m.docType+'</span></div><div class="cd-d">'+m.content.replace(/##/g,'').replace(/[‚ö†Ô∏è‚úÖ]/g,'').substring(0,100)+'...</div><div class="cd-m"><span><span class="pd '+(pc[m.priority]||'')+'"></span> '+m.priority+'</span><span>üè≠ '+(m.model||'-')+'</span><span>üìÖ '+m.updatedAt+'</span></div></div>';}).join('');
}

// ===== DETAIL =====
function openD(id){
var m=null;for(var i=0;i<D.length;i++){if(D[i].id===id){m=D[i];break;}}
if(!m)return;
document.getElementById('lv').style.display='none';
document.getElementById('sts').style.display='none';
var dp=document.getElementById('dp');dp.classList.add('show');
var tc={'Operation Manual':'tg-op','Part Manual':'tg-pt','Service Manual':'tg-sv','Schematic':'tg-sc'};
var isAdm=curUser&&curUser.role==='admin';
var acts='';
if(isAdm)acts='<button class="btn bo bs" onclick="editM(\''+m.id+'\')">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button><button class="btn bd bs" onclick="delM(\''+m.id+'\')">üóëÔ∏è ‡∏•‡∏ö</button>';
acts+='<button class="btn bg bs" onclick="window.print()">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå</button>';
var pdfHtml=buildPdfSection(m);
dp.innerHTML='<div class="dp-bk" onclick="closeDP()">‚óÇ ‡∏Å‡∏•‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div><div class="dp-hd"><h1>'+m.name+'</h1><div class="dp-if"><span class="tg '+tc[m.docType]+'">'+m.docType+'</span><span>üèóÔ∏è '+m.equipType+'</span><span>üè≠ '+(m.model||'-')+'</span><span>üìÖ '+m.updatedAt+'</span></div></div><div class="dp-ac">'+acts+'</div><div class="dp-bd">'+prs(m.content)+pdfHtml+'</div>';
}
function closeDP(){document.getElementById('dp').classList.remove('show');document.getElementById('lv').style.display='block';document.getElementById('sts').style.display='grid';}
function prs(t){return t.replace(/## (.+)/g,'<h4>$1</h4>').replace(/‚ö†Ô∏è ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: (.+)/g,'<div class="wb">‚ö†Ô∏è $1</div>').replace(/‚úÖ ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö: (.+)/g,'<div class="tb">‚úÖ $1</div>').replace(/^(\d+)\. (.+)$/gm,'<li>$2</li>').replace(/^- (.+)$/gm,'<li>$1</li>').replace(/((<li>.*<\/li>\s*)+)/g,'<ul>$1</ul>').replace(/\n\n/g,'<br>').replace(/\n/g,'');}

// ===== PDF =====
function buildPdfSection(m){
var isAdm=curUser&&curUser.role==='admin';
var h='<div class="pdf-sec"><h4>üìé ‡πÑ‡∏ü‡∏•‡πå PDF ‡πÅ‡∏ô‡∏ö</h4>';
if(m.pdfs&&m.pdfs.length>0){
m.pdfs.forEach(function(p){
h+='<div class="pdf-item"><span class="pfi">üìÑ</span><span class="pfn">'+p.fileName+'</span><span class="pfd">'+p.uploadedAt+'</span><div>';
h+='<button class="pfb pfb-v" onclick="event.stopPropagation();openPV(\''+p.viewUrl+'\',\''+p.fileName.replace(/'/g,'')+'\')">üëÅÔ∏è ‡∏î‡∏π</button> ';
if(isAdm)h+='<button class="pfb pfb-d" onclick="event.stopPropagation();delPdf(\''+m.id+'\',\''+p.fileId+'\')">üóëÔ∏è</button>';
h+='</div></div>';
});
}else{h+='<p style="color:var(--gl);font-size:13px;margin-top:8px">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå PDF</p>';}
if(isAdm){
h+='<div class="uz" onclick="upPdf(\''+m.id+'\')"><div class="uz-i">üì§</div><div class="uz-t">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠ <strong>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î PDF</strong></div></div>';
h+='<div class="uprog" id="up-'+m.id+'"><div class="ubar"></div></div>';
}
h+='</div>';
return h;
}
function upPdf(mid){
if(!GAS_URL){toast('‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ API URL ‡∏Å‡πà‡∏≠‡∏ô','err');return;}
var inp=document.getElementById('pdfIn');
inp.onchange=function(ev){
var file=ev.target.files[0];if(!file)return;
if(file.type!=='application/pdf'){toast('‡πÄ‡∏â‡∏û‡∏≤‡∏∞ PDF','err');return;}
var reader=new FileReader();
reader.onload=function(e){
var b64=e.target.result.split(',')[1];
var pg=document.getElementById('up-'+mid);
if(pg){pg.style.display='block';pg.querySelector('.ubar').style.width='40%';}
fetch(GAS_URL,{method:'POST',body:JSON.stringify({action:'upload',fileName:file.name,mimeType:'application/pdf',fileBase64:b64})})
.then(function(r){return r.json();})
.then(function(data){
if(pg)pg.querySelector('.ubar').style.width='100%';
if(data.success){
var m=null;for(var i=0;i<D.length;i++){if(D[i].id===mid){m=D[i];break;}}
if(m){if(!m.pdfs)m.pdfs=[];m.pdfs.push({fileId:data.fileId,fileName:data.fileName,viewUrl:data.viewUrl,uploadedAt:new Date().toISOString().split('T')[0]});sv();}
toast('‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î PDF ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‚úÖ');
setTimeout(function(){openD(mid);},500);
}else{toast('‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: '+(data.error||''),'err');}
if(pg)setTimeout(function(){pg.style.display='none';pg.querySelector('.ubar').style.width='0';},1000);
}).catch(function(){toast('‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ API ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ','err');if(pg)pg.style.display='none';});
};
reader.readAsDataURL(file);
inp.value='';
};
inp.click();
}
function delPdf(mid,fid){
if(!confirm('‡∏•‡∏ö PDF ‡∏ô‡∏µ‡πâ?'))return;
if(GAS_URL){fetch(GAS_URL,{method:'POST',body:JSON.stringify({action:'delete',fileId:fid})}).catch(function(){});}
var m=null;for(var i=0;i<D.length;i++){if(D[i].id===mid){m=D[i];break;}}
if(m&&m.pdfs){m.pdfs=m.pdfs.filter(function(p){return p.fileId!==fid;});sv();openD(mid);toast('‡∏•‡∏ö PDF ‡πÅ‡∏•‡πâ‡∏ß');}
}
function openPV(url,name){document.getElementById('pvwT').textContent=name;document.getElementById('pvwF').src=url;document.getElementById('pvw').classList.add('open');}
function closePV(){document.getElementById('pvw').classList.remove('open');document.getElementById('pvwF').src='';}

// ===== CRUD =====
function openM(id){if(curUser&&curUser.role!=='admin')return;eid=id||null;var m=null;if(id){for(var i=0;i<D.length;i++){if(D[i].id===id){m=D[i];break;}}}document.getElementById('mtt').textContent=m?'‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠':'üîß ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà';document.getElementById('fN').value=m?m.name:'';document.getElementById('fE').value=m?m.equipType:'';document.getElementById('fD').value=m?m.docType:'';document.getElementById('fM').value=m?(m.model||''):'';document.getElementById('fP').value=m?m.priority:'‡∏õ‡∏Å‡∏ï‡∏¥';document.getElementById('fC').value=m?m.content:'';document.getElementById('mbg').classList.add('open');}
function closeM(){document.getElementById('mbg').classList.remove('open');}
function editM(id){openM(id);}
function saveM(){if(curUser&&curUser.role!=='admin')return;var n=document.getElementById('fN').value.trim(),e=document.getElementById('fE').value,d=document.getElementById('fD').value,mo=document.getElementById('fM').value.trim(),p=document.getElementById('fP').value,c=document.getElementById('fC').value.trim();if(!n||!e||!d||!c){toast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö','err');return;}var td=new Date().toISOString().split('T')[0];if(eid){for(var i=0;i<D.length;i++){if(D[i].id===eid){D[i].name=n;D[i].equipType=e;D[i].docType=d;D[i].model=mo;D[i].priority=p;D[i].content=c;D[i].updatedAt=td;break;}}toast('‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‚úÖ');}else{D.unshift({id:Date.now().toString(),name:n,equipType:e,docType:d,model:mo,priority:p,content:c,createdAt:td,updatedAt:td,author:curUser.name,pdfs:[]});toast('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà ‚úÖ');}sv();closeM();closeDP();render();}
function delM(id){if(!confirm('‡∏•‡∏ö‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏ô‡∏µ‡πâ?'))return;D=D.filter(function(m){return m.id!==id;});sv();closeDP();render();toast('‡∏•‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢');}
function toast(m,t){var e=document.getElementById('tt');e.textContent=m;e.className='tst '+(t||'ok')+' show';setTimeout(function(){e.classList.remove('show');},3000);}

// ===== START =====
checkSession();
</script>
</body>
</html>
